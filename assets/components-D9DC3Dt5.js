import{R as V,j as t,r as a,F as S,f as W,a as X,b as Y,B as K,c as Z,d as ee}from"./vendor-C0PXxGFu.js";function te(o,f){let c;return function(...u){clearTimeout(c),c=setTimeout(()=>o.apply(this,u),f)}}const se=V.memo(V.forwardRef(({testCase:o,onChange:f,onStatusChange:c,onCheckboxChange:u,isChecked:g,onClick:l},m)=>t.jsxs("div",{className:"py-2 flex items-center border-gray-600 space-x-5 overflow-x-hidden mr-3","data-replicated-value":o.content,onClick:l,children:[t.jsxs("label",{className:"container flex w-1",children:[t.jsx("input",{type:"checkbox",checked:g,onChange:u,className:"checkbox peer"}),t.jsx("span",{className:"checkmark rounded border border-gray-500 hover:border-gray-50 peer-checked:bg-sky-700 peer-checked:border-none"})]}),t.jsx("div",{className:`w-full ${o.status===""?"":"border-dashed border-x border-gray-700"}`,children:t.jsx("textarea",{ref:m,className:`px-3 bg-inherit rounded overflow-hidden resize-none w-full flex items-center 
              ${o.status===""?"text-gray-400 pl-2":"text-[#FAF9F6] pl-6"}  
              ${o.isBold?"bold-textarea focus:outline-none":"text-sm"}
            `,value:o.content,onChange:b=>f(b.target.value),placeholder:`Test case ${o.id}`,rows:o.status===""?1:""})}),o.status!==""&&t.jsxs("select",{className:`p-1 cursor-pointer text-sm rounded focus:outline-none ${o.status==="notstarted"?"bg-yellow-200":o.status==="passed"?"bg-green-200":o.status==="failed"?"bg-rose-300":o.status==="blocked"?"bg-indigo-200":o.status==="notapplicable"?"bg-gray-300":"bg-yellow-200"}`,value:o.status,onChange:b=>c(b.target.value),children:[t.jsx("option",{className:"bg-slate-200",value:"notstarted",children:"NOT STARTED"}),t.jsx("option",{className:"bg-slate-200",value:"passed",children:"PASSED"}),t.jsx("option",{className:"bg-slate-200",value:"failed",children:"FAILED"}),t.jsx("option",{className:"bg-slate-200",value:"blocked",children:"BLOCKED"}),t.jsx("option",{className:"bg-slate-200",value:"notapplicable",children:"NOT APPLICABLE"})]})]},o.id))),i={DEFAULT:"#1C1C1E",SECOND:"#F39F5A",THIRD:"#9D3233"},ae=({isOpen:o,onClose:f,nodeId:c,nodeLabel:u,nodeColor:g="#1C1C1E",testCases:l,onSave:m})=>{const[b,k]=a.useState(u),[x,D]=a.useState(g||i.DEFAULT),[n,p]=a.useState(l),[C,w]=a.useState([]),h=a.useRef([]),[I,H]=a.useState(g||i.DEFAULT),[y,N]=a.useState(""),[B,j]=a.useState(!1);a.useEffect(()=>{p(l)},[l,c]);const F={toastSave:()=>{K.success("Changes Saved Successfully!",{autoClose:1e3})},toastSaveError:()=>{K.error("Failed to save data. Please try again.",{autoClose:1e3})}},M=a.useCallback(te(async()=>{try{if(!c)throw new Error("Node ID is not defined");const e=n.length,s=n.filter(v=>v.status==="passed").length,r=n.filter(v=>v.status==="failed").length,d=n.filter(v=>v.status==="notstarted").length,T=n.filter(v=>v.status==="notapplicable").length;m&&m(n,b,x,{total:e,passed:s,failed:r,pending:d,notApplicable:T}),F.toastSave()}catch(e){console.error("Failed to save data:",e),F.toastSaveError()}},1e3),[n,b,x,c,m,F]),E=a.useCallback(()=>{requestAnimationFrame(()=>{const e=h.current.map(s=>s?(s.style.height="auto",s.scrollHeight):0);h.current.forEach((s,r)=>{s&&(s.style.height=`${e[r]}px`)})})},[]),z=a.useCallback(()=>{E(),M()},[E,M]),A=a.useCallback(e=>{const s=e.target.value;/^#[0-9A-Fa-f]{6}$/.test(s)?(D(s),H(s)):console.error("Invalid color format. Please use #rrggbb format.")},[]),P=a.useCallback(()=>{const e={id:Date.now(),content:"",status:"",isBold:!0};p(s=>[...s,e])},[]),O=a.useCallback((e,s)=>{p(r=>r.map(d=>d.id===e?{...d,content:s}:d))},[]),L=a.useCallback(()=>{const e={id:Date.now(),content:"",status:"notstarted"};p(s=>[...s,e])},[]),q=a.useCallback((e,s)=>{p(r=>r.map(d=>d.id===e?{...d,status:s}:d))},[]),J=a.useCallback(()=>{p(e=>e.filter(s=>!C.includes(s.id))),w([])},[C]),_=a.useCallback(e=>{if(e.target.checked){const s=n.map(r=>r.id);w(s)}else w([])},[n]),G=a.useCallback(e=>{w(s=>s.includes(e)?s.filter(r=>r!==e):[...s,e])},[]),$=n.filter(e=>e.content.toLowerCase().includes(y.toLowerCase())),U=a.useCallback(e=>{h.current[e]&&(h.current[e].scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}),h.current[e].focus())},[]),Q=a.useCallback(e=>{y&&(N(""),setTimeout(()=>{U(e)},0))},[y,U]);a.useEffect(()=>{o&&(k(u),D(g||i.DEFAULT),p(l),w([]))},[u,l,g,o]),a.useEffect(()=>{const e=JSON.parse(localStorage.getItem(`testCases-${c}`)),s=localStorage.getItem(`label-${c}`),r=localStorage.getItem(`color-${c}`);s&&k(s),e&&p(e),r&&(D(r),H(r)),setTimeout(()=>{document.querySelectorAll(".modal-content textarea").forEach(T=>{T.parentNode.dataset.replicatedValue=T.value})},0)},[c,o]);const R=a.useCallback(e=>{B||(e.ctrlKey&&e.key==="Enter"?(y&&N(""),L(),j(!0)):e.altKey&&e.key==="Enter"?(y&&N(""),P(),j(!0)):e.ctrlKey&&e.key.toLowerCase()==="s"?(e.preventDefault(),document.querySelector(".modal-save").focus(),z(),j(!0)):e.ctrlKey&&e.key.toLowerCase()==="f"&&(e.preventDefault(),document.querySelector(".search-input").focus(),j(!0)),setTimeout(()=>{j(!1)},100))},[y,L,P,B]);return a.useEffect(()=>(document.addEventListener("keydown",R),()=>{document.removeEventListener("keydown",R)}),[R]),a.useEffect(()=>{o&&E()},[o,E]),a.useEffect(()=>{var e;h.current.length>0&&(h.current.forEach(s=>{s&&(s.style.height="auto")}),(e=h.current[h.current.length-1])==null||e.focus())},[n.length]),a.useEffect(()=>{const e=document.querySelector(".modal-content");e&&(e.style.borderTopColor=I)},[I]),t.jsx(t.Fragment,{children:o&&t.jsx("div",{className:"modal-overlay z-0 select-none",children:t.jsxs("div",{className:"modal-content bg-[#1C1C1E] flex flex-col max-h-[90vh] min-w-[800px] border-t-4",style:{borderColor:x},children:[t.jsx("span",{className:"close bg-inherit text-white text-5xl hover:bg-rose-500",onClick:f,children:"×"}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("input",{type:"text",className:"bg-inherit text-slate-200 font-bold p-1 rounded mr-5 w-2/3 text-xl focus:outline focus:outline-white",value:b,onChange:e=>k(e.target.value),placeholder:"Node Label"}),t.jsxs("div",{className:"flex items-center w-fit space-x-3 px-2 ml-10",children:[t.jsx("button",{onClick:()=>A({target:{value:i.DEFAULT}}),className:`w-8 h-8 rounded border-2 ${x===i.DEFAULT?" border-[#FAF9F6]":"border-gray-500"}`,style:{backgroundColor:i.DEFAULT},"aria-label":"DEFAULT"}),t.jsx("button",{onClick:()=>A({target:{value:i.SECOND}}),className:`w-8 h-8 rounded border-2 ${x===i.SECOND?" border-[#FAF9F6]":"border-gray-500"}`,style:{backgroundColor:i.SECOND},"aria-label":"SECOND"}),t.jsx("button",{onClick:()=>A({target:{value:i.THIRD}}),className:`w-8 h-8 rounded border-2 ${x===i.THIRD?" border-[#FAF9F6]":"border-gray-500"}`,style:{backgroundColor:i.THIRD},"aria-label":"THIRD"})]})]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("label",{className:"p-2 rounded flex items-center border-gray-600 cursor-pointer space-x-4 ",children:[t.jsx("input",{type:"checkbox",onChange:_,checked:C.length===n.length&&n.length>0}),t.jsx("span",{className:"text-white",children:"Select All"})]}),t.jsx("input",{type:"text",className:"search-input placeholder:italic p-1 px-3 text-sm text-white rounded border border-gray-600 bg-inherit",placeholder:"Search keywords...",value:y,onChange:e=>N(e.target.value)})]}),t.jsx("hr",{className:"mb-4 mt-2 border-gray-600 border-1"}),y&&t.jsxs("label",{className:"text-gray-400 text-xs",children:[$.length," test case",$.length>1?"s":""," found"]}),t.jsx("div",{className:"modal-body overflow-y-auto pb-[10px] divide-y divide-dashed",children:$.map((e,s)=>t.jsx(se,{testCase:e,onChange:r=>O(e.id,r),onStatusChange:r=>q(e.id,r),onCheckboxChange:()=>G(e.id),isChecked:C.includes(e.id),ref:r=>h.current[n.findIndex(d=>d.id===e.id)]=r,onClick:()=>Q(n.findIndex(r=>r.id===e.id))},e.id))}),t.jsxs("div",{className:"button-container sticky bottom-0 left-0 right-0 bg-[#1C1C1E] pt-5 space-x-3 z-10",children:[t.jsx("button",{className:"p-2 rounded w-12 bg-[#3e3e3e] hover:bg-[#2980B9]",onClick:L,children:t.jsx(S,{icon:W,size:"lg",color:"white"})}),t.jsx("button",{className:"modal-save p-2 rounded w-12 bg-[#3e3e3e] hover:bg-[#2980B9]",onClick:z,children:t.jsx(S,{icon:X,size:"lg",color:"white"})}),t.jsx("button",{className:`p-2 rounded w-12 ${C.length>0?"bg-red-600 hover:bg-red-800":"bg-gray-600 cursor-not-allowed"}`,onClick:J,disabled:C.length===0,style:{cursor:C.length===0?"not-allowed":"pointer"},children:t.jsx(S,{icon:Y,size:"lg",color:"white"})})]})]})})})},ne=ae,oe=({isOpen:o,onClose:f,onSelectVersion:c})=>{const[u,g]=a.useState([]);return a.useEffect(()=>{o&&fetch("http://localhost:3000/versions.json").then(l=>{if(!l.ok)throw new Error("Failed to fetch flow data");return l.json()}).then(l=>{if(l.versions){const b=l.versions.sort((k,x)=>new Date(x.timestamp)-new Date(k.timestamp));g(b)}else console.error("Invalid data structure:",l)}).catch(l=>{console.error("Failed to fetch versions:",l)})},[o]),o?t.jsx("div",{className:"modal-overlay z-0 select-none text-slate-200",onClick:f,children:t.jsxs("div",{className:"modal-content bg-[#1C1C1E] flex flex-col max-h-[90vh] min-w-[500px]",onClick:l=>l.stopPropagation(),children:[t.jsxs("div",{className:"modal-header",children:[t.jsx("h2",{className:"font-bold text-xl",children:"Version History"}),t.jsx("span",{className:"close bg-inherit text-white text-5xl hover:bg-rose-500",onClick:f,children:"×"}),t.jsx("hr",{className:"mb-4 mt-2 border-gray-600 border-1"})]}),t.jsx("div",{className:"modal-body divide-y divide-dashed ",children:u.length===0?t.jsx("p",{children:"No versions available."}):t.jsx("ul",{className:"space-y-3 peer",children:u.map((l,m)=>t.jsx("li",{children:t.jsxs("button",{className:"link-button border border-gray-600 w-full px-2 text-right pr-7 py-2 rounded hover:bg-gray-800 hover:border-white",onClick:()=>c(l.flowData),children:[t.jsx(S,{icon:Z,className:"float-left peer-hover:pl-10",size:"lg",color:"white"}),ee(new Date(l.timestamp),"MMMM dd, h:mm a")]})},m))})})]})}):null},ce=oe;export{ne as M,ce as V};
