import{R as I,j as s,r as l,F as A,f as q,a as J,b as M,B}from"./vendor-CnLy6pY0.js";function V(a,p){let r;return function(...u){clearTimeout(r),r=setTimeout(()=>a.apply(this,u),p)}}const c={DEFAULT:"#1C1C1E",SECOND:"#F39F5A",THIRD:"#9D3233"},_=I.memo(I.forwardRef(({testCase:a,onChange:p,onStatusChange:r,onCheckboxChange:u,isChecked:x},C)=>s.jsxs("div",{className:"py-2 flex items-center border-gray-600 space-x-5 overflow-x-hidden","data-replicated-value":a.content,children:[s.jsxs("label",{className:"container flex w-1",children:[s.jsx("input",{type:"checkbox",checked:x,onChange:u,className:"checkbox peer"}),s.jsx("span",{className:"checkmark rounded border border-gray-500 hover:border-gray-50 peer-checked:bg-sky-700 peer-checked:border-none"})]}),s.jsx("div",{className:`w-full ${a.status===""?"":"border-dashed border-x border-gray-700"}`,children:s.jsx("textarea",{ref:C,className:`px-3 bg-inherit rounded overflow-hidden resize-none w-full flex items-center ${a.status===""?"text-gray-400 pl-2":"text-[#FAF9F6] pl-6"}  ${a.isBold?"bold-textarea focus:outline-none":"text-sm"}`,value:a.content,onChange:h=>p(h.target.value),placeholder:`Test case ${a.id}`,rows:a.status===""?1:""})}),a.status!==""&&s.jsxs("select",{className:`p-1 cursor-pointer text-sm rounded focus:outline-none ${a.status==="notstarted"?"bg-yellow-200":a.status==="passed"?"bg-green-200":a.status==="failed"?"bg-rose-300":a.status==="blocked"?"bg-indigo-200":a.status==="notapplicable"?"bg-gray-300":"bg-yellow-200"}`,value:a.status,onChange:h=>r(h.target.value),children:[s.jsx("option",{className:"bg-slate-200",value:"notstarted",children:"NOT STARTED"}),s.jsx("option",{className:"bg-slate-200",value:"passed",children:"PASSED"}),s.jsx("option",{className:"bg-slate-200",value:"failed",children:"FAILED"}),s.jsx("option",{className:"bg-slate-200",value:"blocked",children:"BLOCKED"}),s.jsx("option",{className:"bg-slate-200",value:"notapplicable",children:"NOT APPLICABLE"})]})]},a.id))),G=({isOpen:a,onClose:p,nodeId:r,nodeLabel:u,nodeColor:x="#1C1C1E",testCases:C,onSave:h})=>{const[k,E]=l.useState(u),[i,w]=l.useState(x||c.DEFAULT),[n,g]=l.useState(C),[b,y]=l.useState([]),f=l.useRef([]),[$,S]=l.useState(x||c.DEFAULT),j={toastSave:()=>{B.success("Changes Saved Successfully!",{autoClose:1e3})},toastSaveError:()=>{B.error("Failed to save data. Please try again.",{autoClose:1e3})}},L=l.useCallback(V(async()=>{try{if(!r)throw new Error("Node ID is not defined");const e=n.length,t=n.filter(m=>m.status==="passed").length,o=n.filter(m=>m.status==="failed").length,d=n.filter(m=>m.status==="notstarted").length,v=n.filter(m=>m.status==="notapplicable").length,O={total:e,passed:t,failed:o,pending:d,notApplicable:v};localStorage.setItem(`testCases-${r}`,JSON.stringify(n)),localStorage.setItem(`label-${r}`,k),localStorage.setItem(`color-${r}`,i),localStorage.setItem(`testCaseStats-${r}`,JSON.stringify(O)),S(i),h&&h(n,k,i,O),j.toastSave()}catch(e){console.error("Failed to save data:",e),j.toastSaveError()}},1e3),[n,k,i,r,h,j]),N=l.useCallback(()=>{requestAnimationFrame(()=>{const e=f.current.map(t=>t?(t.style.height="auto",t.scrollHeight):0);f.current.forEach((t,o)=>{t&&(t.style.height=`${e[o]}px`)})})},[]),T=l.useCallback(()=>{N(),L()},[N,L]),F=l.useCallback(e=>{const t=e.target.value;/^#[0-9A-Fa-f]{6}$/.test(t)?(w(t),S(t)):console.error("Invalid color format. Please use #rrggbb format.")},[]),R=l.useCallback(()=>{const e={id:Date.now(),content:"",status:"",isBold:!0};g(t=>[...t,e])},[]),U=l.useCallback((e,t)=>{g(o=>o.map(d=>d.id===e?{...d,content:t}:d))},[]),D=l.useCallback(()=>{const e={id:Date.now(),content:"",status:"notstarted"};g(t=>[...t,e])},[]),H=l.useCallback((e,t)=>{g(o=>o.map(d=>d.id===e?{...d,status:t}:d))},[]),P=l.useCallback(()=>{g(e=>e.filter(t=>!b.includes(t.id))),y([])},[b]),z=l.useCallback(e=>{if(e.target.checked){const t=n.map(o=>o.id);y(t)}else y([])},[n]),K=l.useCallback(e=>{y(t=>t.includes(e)?t.filter(o=>o!==e):[...t,e])},[]);return l.useEffect(()=>{E(u),w(x||c.DEFAULT),g(C),y([])},[u,C,x,a]),l.useEffect(()=>{const e=JSON.parse(localStorage.getItem(`testCases-${r}`)),t=localStorage.getItem(`label-${r}`),o=localStorage.getItem(`color-${r}`);t&&E(t),e&&g(e),o&&(w(o),S(o)),setTimeout(()=>{document.querySelectorAll(".modal-content textarea").forEach(v=>{v.parentNode.dataset.replicatedValue=v.value})},0)},[r,a]),l.useEffect(()=>{const e=t=>{t.ctrlKey&&t.key==="Enter"&&D(),t.altKey&&t.key==="Enter"&&R(),t.ctrlKey&&t.key.toLowerCase()==="s"&&(t.preventDefault(),T())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[D,R,T]),l.useEffect(()=>{a&&N()},[a,N]),l.useEffect(()=>{var e;f.current.length>0&&(f.current.forEach(t=>{t&&(t.style.height="auto")}),(e=f.current[f.current.length-1])==null||e.focus())},[n.length]),l.useEffect(()=>{const e=document.querySelector(".modal-content");e&&(e.style.borderTopColor=$)},[$]),s.jsx(s.Fragment,{children:a&&s.jsx("div",{className:"modal-overlay z-0 select-none",children:s.jsxs("div",{className:"modal-content bg-[#1C1C1E] flex flex-col max-h-[90vh] min-w-[800px] border-t-4",style:{borderColor:i},children:[s.jsx("span",{className:"close bg-inherit text-white text-5xl hover:bg-rose-500",onClick:p,children:"Ã—"}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"text",className:"bg-inherit text-slate-200 font-bold p-1 rounded mr-5 w-2/3 text-xl focus:outline focus:outline-white",value:k,onChange:e=>E(e.target.value),placeholder:"Node Label"}),s.jsxs("div",{className:"flex items-center w-fit space-x-3 px-2 ml-10",children:[s.jsx("button",{onClick:()=>F({target:{value:c.DEFAULT}}),className:`w-8 h-8 rounded border-2 ${i===c.DEFAULT?" border-[#FAF9F6]":"border-gray-500"}`,style:{backgroundColor:c.DEFAULT},"aria-label":"DEFAULT"}),s.jsx("button",{onClick:()=>F({target:{value:c.SECOND}}),className:`w-8 h-8 rounded border-2 ${i===c.SECOND?" border-[#FAF9F6]":"border-gray-500"}`,style:{backgroundColor:c.SECOND},"aria-label":"SECOND"}),s.jsx("button",{onClick:()=>F({target:{value:c.THIRD}}),className:`w-8 h-8 rounded border-2 ${i===c.THIRD?" border-[#FAF9F6]":"border-gray-500"}`,style:{backgroundColor:c.THIRD},"aria-label":"THIRD"})]})]}),s.jsxs("label",{className:"p-2 rounded flex items-center border-gray-600 cursor-pointer w-fit space-x-4 ",children:[s.jsx("input",{type:"checkbox",onChange:z,checked:b.length===n.length&&n.length>0}),s.jsx("span",{className:"text-white",children:"Select All"})]}),s.jsx("hr",{className:"mb-4 mt-2 border-gray-600 border-1"}),s.jsx("div",{className:"modal-body overflow-y-auto pb-[10px] divide-y divide-dashed",children:n.map((e,t)=>s.jsx(_,{testCase:e,onChange:o=>U(e.id,o),onStatusChange:o=>H(e.id,o),onCheckboxChange:()=>K(e.id),isChecked:b.includes(e.id),ref:o=>f.current[t]=o},e.id))}),s.jsxs("div",{className:"button-container sticky bottom-0 left-0 right-0 bg-[#1C1C1E] pt-5 space-x-3 z-10",children:[s.jsx("button",{className:"p-2 rounded w-12 bg-[#3e3e3e] hover:bg-[#2980B9]",onClick:D,children:s.jsx(A,{icon:q,size:"lg",color:"white"})}),s.jsx("button",{className:"p-2 rounded w-12 bg-[#3e3e3e] hover:bg-[#2980B9]",onClick:T,children:s.jsx(A,{icon:J,size:"lg",color:"white"})}),s.jsx("button",{className:`p-2 rounded w-12 ${b.length>0?"bg-red-600 hover:bg-red-800":"bg-gray-600 cursor-not-allowed"}`,onClick:P,disabled:b.length===0,style:{cursor:b.length===0?"not-allowed":"pointer"},children:s.jsx(A,{icon:M,size:"lg",color:"white"})})]})]})})})},W=G;export{W as M};
